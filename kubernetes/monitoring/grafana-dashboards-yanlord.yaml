apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards-yanlord
  namespace: monitoring
data:
  yanlord-comprehensive.json: |
    {"annotations":{"list":[{"builtIn":1,"datasource":{"type":"grafana","uid":"-- Grafana --"},"enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":1,"id":null,"links":[],"liveNow":true,"panels":[{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":100,"panels":[],"title":"\ud83d\udcca \u5e94\u7528\u6982\u89c8","type":"row"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[{"options":{"0":{"color":"red","index":0,"text":"Down"},"1":{"color":"green","index":1,"text":"Running"}},"type":"value"}],"thresholds":{"mode":"absolute","steps":[{"color":"red","value":null},{"color":"green","value":1}]},"unit":"none"}},"gridPos":{"h":4,"w":4,"x":0,"y":1},"id":1,"options":{"colorMode":"background","graphMode":"none","justifyMode":"center","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"textMode":"value_and_name"},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"expr":"sum(kube_pod_status_phase{namespace=\"default\",pod=~\"yanlord-booking.*\",phase=\"Running\"})","refId":"A"}],"title":"\u5e94\u7528\u72b6\u6001","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":5},{"color":"red","value":10}]},"unit":"short"}},"gridPos":{"h":4,"w":4,"x":4,"y":1},"id":2,"options":{"colorMode":"value","graphMode":"area","justifyMode":"center","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"textMode":"value_and_name"},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"expr":"sum(kube_pod_container_status_restarts_total{namespace=\"default\",pod=~\"yanlord-booking.*\"})","refId":"A"}],"title":"\u603b\u91cd\u542f\u6b21\u6570","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"s"}},"gridPos":{"h":4,"w":4,"x":8,"y":1},"id":3,"options":{"colorMode":"value","graphMode":"area","justifyMode":"center","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"textMode":"value_and_name"},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"expr":"time() - max(kube_pod_start_time{namespace=\"default\",pod=~\"yanlord-booking-regular.*\"})","refId":"A"}],"title":"\u8fd0\u884c\u65f6\u95f4","type":"stat"},{"datasource":{"type":"loki","uid":"loki"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"hideFrom":{"legend":false,"tooltip":false,"viz":false}},"mappings":[]}},"gridPos":{"h":4,"w":12,"x":12,"y":1},"id":4,"options":{"displayLabels":["percent"],"legend":{"displayMode":"table","placement":"right","showLegend":true,"values":["value"]},"pieType":"donut","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"tooltip":{"mode":"single","sort":"none"}},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"loki","uid":"loki"},"expr":"sum by (levelname) (count_over_time({namespace=\"default\",pod=~\"yanlord-booking.*\"} | json | __error__=\"\" [24h]))","refId":"A"}],"title":"\u65e5\u5fd7\u7ea7\u522b\u5206\u5e03 (24h)","type":"piechart"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":5},"id":101,"panels":[],"title":"\ud83c\udfaf \u4e1a\u52a1\u6307\u6807","type":"row"},{"datasource":{"type":"loki","uid":"loki"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"bars","fillOpacity":80,"gradientMode":"none","hideFrom":{"tooltip":false,"viz":false,"legend":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"},"overrides":[{"matcher":{"id":"byRegexp","options":".*\u6210\u529f.*"},"properties":[{"id":"color","value":{"fixedColor":"green","mode":"fixed"}}]},{"matcher":{"id":"byRegexp","options":".*\u5931\u8d25.*"},"properties":[{"id":"color","value":{"fixedColor":"red","mode":"fixed"}}]}]},"gridPos":{"h":8,"w":12,"x":0,"y":6},"id":5,"options":{"legend":{"calcs":["sum","mean"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"loki","uid":"loki"},"expr":"sum by (result) (count_over_time({namespace=\"default\",pod=~\"yanlord-booking.*\"} |~ \"\u9884\u8ba2.*\" | json | result != \"\" [$__interval]))","legendFormat":"{{result}}","refId":"A"}],"title":"\u9884\u8ba2\u7ed3\u679c\u8d8b\u52bf","type":"timeseries"},{"datasource":{"type":"loki","uid":"loki"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"align":"auto","cellOptions":{"type":"auto"},"inspect":false},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]}}},"gridPos":{"h":8,"w":12,"x":12,"y":6},"id":6,"options":{"cellHeight":"sm","footer":{"countRows":false,"fields":"","reducer":["sum"],"show":false},"showHeader":true,"sortBy":[{"desc":true,"displayName":"Count"}]},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"loki","uid":"loki"},"expr":"topk(10, sum by (message) (count_over_time({namespace=\"default\",pod=~\"yanlord-booking.*\"} | json | levelname=\"ERROR\" | line_format \"{{.message}}\" [24h])))","refId":"A"}],"title":"Top 10 \u9519\u8bef\u4fe1\u606f (24h)","transformations":[{"id":"labelsToFields","options":{"mode":"columns","valueLabel":"message"}},{"id":"organize","options":{"excludeByName":{"Time":true},"indexByName":{},"renameByName":{"Value":"Count","message":"\u9519\u8bef\u4fe1\u606f"}}}],"type":"table"},{"datasource":{"type":"loki","uid":"loki"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"red","value":null},{"color":"yellow","value":50},{"color":"green","value":80}]},"unit":"percent"}},"gridPos":{"h":6,"w":6,"x":0,"y":14},"id":7,"options":{"orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":true},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"loki","uid":"loki"},"expr":"sum(count_over_time({namespace=\"default\",pod=~\"yanlord-booking.*\"} |~ \"\u9884\u8ba2\u6210\u529f\" [24h])) / sum(count_over_time({namespace=\"default\",pod=~\"yanlord-booking.*\"} |~ \"\u9884\u8ba2.*\" [24h])) * 100","refId":"A"}],"title":"\u9884\u8ba2\u6210\u529f\u7387 (24h)","type":"gauge"},{"datasource":{"type":"loki","uid":"loki"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":10},{"color":"red","value":50}]},"unit":"short"}},"gridPos":{"h":6,"w":6,"x":6,"y":14},"id":8,"options":{"colorMode":"value","graphMode":"area","justifyMode":"center","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"textMode":"value_and_name"},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"loki","uid":"loki"},"expr":"sum(count_over_time({namespace=\"default\",pod=~\"yanlord-booking.*\"} | json | levelname=\"ERROR\" [1h]))","refId":"A"}],"title":"\u9519\u8bef\u6570 (1h)","type":"stat"},{"datasource":{"type":"loki","uid":"loki"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"hideFrom":{"legend":false,"tooltip":false,"viz":false}},"mappings":[]}},"gridPos":{"h":6,"w":12,"x":12,"y":14},"id":9,"options":{"displayLabels":["name","percent"],"legend":{"displayMode":"table","placement":"right","showLegend":true,"values":["value","percent"]},"pieType":"pie","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"tooltip":{"mode":"single","sort":"none"}},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"loki","uid":"loki"},"expr":"sum by (pod) (count_over_time({namespace=\"default\",pod=~\"yanlord-booking.*\"} | json | levelname=\"ERROR\" [24h]))","refId":"A"}],"title":"\u9519\u8bef\u5206\u5e03 - \u6309 Pod","type":"piechart"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":20},"id":102,"panels":[],"title":"\u2699\ufe0f \u6280\u672f\u6307\u6807","type":"row"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":20,"gradientMode":"none","hideFrom":{"tooltip":false,"viz":false,"legend":false},"lineInterpolation":"smooth","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"percent"}},"gridPos":{"h":8,"w":12,"x":0,"y":21},"id":10,"options":{"legend":{"calcs":["mean","max"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"expr":"sum(rate(container_cpu_usage_seconds_total{namespace=\"default\",pod=~\"yanlord-booking.*\",container!=\"\"}[5m])) by (pod) * 100","legendFormat":"{{pod}}","refId":"A"}],"title":"Pod CPU \u4f7f\u7528\u7387","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":20,"gradientMode":"none","hideFrom":{"tooltip":false,"viz":false,"legend":false},"lineInterpolation":"smooth","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"bytes"}},"gridPos":{"h":8,"w":12,"x":12,"y":21},"id":11,"options":{"legend":{"calcs":["mean","max"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"expr":"sum(container_memory_working_set_bytes{namespace=\"default\",pod=~\"yanlord-booking.*\",container!=\"\"}) by (pod)","legendFormat":"{{pod}}","refId":"A"}],"title":"Pod \u5185\u5b58\u4f7f\u7528","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"tooltip":false,"viz":false,"legend":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"Bps"},"overrides":[{"matcher":{"id":"byRegexp","options":".*receive.*"},"properties":[{"id":"custom.transform","value":"negative-Y"}]}]},"gridPos":{"h":8,"w":12,"x":0,"y":29},"id":12,"options":{"legend":{"calcs":["mean"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"expr":"sum(rate(container_network_transmit_bytes_total{namespace=\"default\",pod=~\"yanlord-booking.*\"}[5m])) by (pod)","legendFormat":"{{pod}} - transmit","refId":"A"},{"datasource":{"type":"prometheus","uid":"prometheus"},"expr":"sum(rate(container_network_receive_bytes_total{namespace=\"default\",pod=~\"yanlord-booking.*\"}[5m])) by (pod)","legendFormat":"{{pod}} - receive","refId":"B"}],"title":"\u7f51\u7edc\u6d41\u91cf","type":"timeseries"},{"datasource":{"type":"loki","uid":"loki"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"none","hideFrom":{"tooltip":false,"viz":false,"legend":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"},"overrides":[{"matcher":{"id":"byName","options":"ERROR"},"properties":[{"id":"color","value":{"fixedColor":"red","mode":"fixed"}}]},{"matcher":{"id":"byName","options":"WARNING"},"properties":[{"id":"color","value":{"fixedColor":"yellow","mode":"fixed"}}]},{"matcher":{"id":"byName","options":"INFO"},"properties":[{"id":"color","value":{"fixedColor":"blue","mode":"fixed"}}]}]},"gridPos":{"h":8,"w":12,"x":12,"y":29},"id":13,"options":{"legend":{"calcs":["sum"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"loki","uid":"loki"},"expr":"sum by (levelname) (rate({namespace=\"default\",pod=~\"yanlord-booking.*\"} | json | __error__=\"\" [$__interval]))","legendFormat":"{{levelname}}","refId":"A"}],"title":"\u65e5\u5fd7\u901f\u7387 - \u6309\u7ea7\u522b","type":"timeseries"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":37},"id":103,"panels":[],"title":"\ud83d\udcc5 CronJob \u76d1\u63a7","type":"row"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"align":"auto","cellOptions":{"type":"color-text"},"inspect":false},"mappings":[{"options":{"0":{"color":"red","index":0,"text":"Inactive"},"1":{"color":"green","index":1,"text":"Active"}},"type":"value"}],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]}},"overrides":[{"matcher":{"id":"byName","options":"Job"},"properties":[{"id":"custom.width","value":300}]},{"matcher":{"id":"byName","options":"Status"},"properties":[{"id":"custom.width","value":150}]}]},"gridPos":{"h":6,"w":12,"x":0,"y":38},"id":14,"options":{"cellHeight":"sm","footer":{"countRows":false,"fields":"","reducer":["sum"],"show":false},"showHeader":true},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"prometheus","uid":"prometheus"},"expr":"kube_cronjob_status_active{namespace=\"default\"}","format":"table","instant":true,"refId":"A"}],"title":"CronJob \u72b6\u6001","transformations":[{"id":"organize","options":{"excludeByName":{"Time":true,"__name__":true,"container":true,"endpoint":true,"instance":true,"job":true,"namespace":true,"pod":true,"service":true},"indexByName":{},"renameByName":{"Value":"Status","cronjob":"Job"}}}],"type":"table"},{"datasource":{"type":"loki","uid":"loki"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"bars","fillOpacity":80,"gradientMode":"none","hideFrom":{"tooltip":false,"viz":false,"legend":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"}},"gridPos":{"h":6,"w":12,"x":12,"y":38},"id":15,"options":{"legend":{"calcs":["sum"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"mode":"multi","sort":"none"}},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"loki","uid":"loki"},"expr":"sum by (pod) (count_over_time({namespace=\"default\",pod=~\"yanlord-booking-(regular|aggressive|prewarm).*\"} |~ \"Start booking\" [$__interval]))","legendFormat":"{{pod}}","refId":"A"}],"title":"CronJob \u6267\u884c\u9891\u7387","type":"timeseries"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":44},"id":104,"panels":[],"title":"\ud83d\udcdd \u5b9e\u65f6\u65e5\u5fd7","type":"row"},{"datasource":{"type":"loki","uid":"loki"},"gridPos":{"h":10,"w":24,"x":0,"y":45},"id":16,"options":{"dedupStrategy":"none","enableLogDetails":true,"prettifyLogMessage":false,"showCommonLabels":false,"showLabels":false,"showTime":true,"sortOrder":"Descending","wrapLogMessage":false},"pluginVersion":"10.2.3","targets":[{"datasource":{"type":"loki","uid":"loki"},"expr":"{namespace=\"default\",pod=~\"yanlord-booking.*\"} | json","refId":"A"}],"title":"\u5b9e\u65f6\u65e5\u5fd7\u6d41","type":"logs"}],"refresh":"30s","schemaVersion":38,"style":"dark","tags":["yanlord","badminton","booking","monitoring"],"templating":{"list":[]},"time":{"from":"now-6h","to":"now"},"timepicker":{},"timezone":"browser","title":"Yanlord Badminton Booking - \u7efc\u5408\u76d1\u63a7","uid":"yanlord-comprehensive","version":0,"weekStart":""}
  local-system-k8s-monitoring.json: |
    {"annotations":{"list":[]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":1,"id":null,"links":[],"liveNow":false,"panels":[{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":100,"panels":[],"title":"\u96c6\u7fa4\u6982\u89c8","type":"row"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"}},"gridPos":{"h":4,"w":4,"x":0,"y":1},"id":1,"options":{"colorMode":"value","graphMode":"area","justifyMode":"center","orientation":"auto","reduceOptions":{"values":false,"calcs":["lastNotNull"],"fields":""},"textMode":"auto"},"targets":[{"expr":"count(kube_node_info)","refId":"A"}],"title":"\u8282\u70b9\u6570\u91cf","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"}},"gridPos":{"h":4,"w":4,"x":4,"y":1},"id":2,"options":{"colorMode":"value","graphMode":"area","justifyMode":"center","orientation":"auto","reduceOptions":{"values":false,"calcs":["lastNotNull"],"fields":""},"textMode":"auto"},"targets":[{"expr":"sum(kube_pod_info)","refId":"A"}],"title":"\u8fd0\u884c\u4e2d\u7684 Pod","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"}},"gridPos":{"h":4,"w":4,"x":8,"y":1},"id":3,"options":{"colorMode":"value","graphMode":"area","justifyMode":"center","orientation":"auto","reduceOptions":{"values":false,"calcs":["lastNotNull"],"fields":""},"textMode":"auto"},"targets":[{"expr":"count(container_last_seen{name!=\"\",name!~\"POD\"})","refId":"A"}],"title":"\u5bb9\u5668\u6570\u91cf","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"}},"gridPos":{"h":4,"w":4,"x":12,"y":1},"id":4,"options":{"colorMode":"value","graphMode":"area","justifyMode":"center","orientation":"auto","reduceOptions":{"values":false,"calcs":["lastNotNull"],"fields":""},"textMode":"auto"},"targets":[{"expr":"sum(kube_deployment_status_replicas)","refId":"A"}],"title":"Deployment \u526f\u672c","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"}},"gridPos":{"h":4,"w":4,"x":16,"y":1},"id":5,"options":{"colorMode":"value","graphMode":"area","justifyMode":"center","orientation":"auto","reduceOptions":{"values":false,"calcs":["lastNotNull"],"fields":""},"textMode":"auto"},"targets":[{"expr":"count(kube_service_info)","refId":"A"}],"title":"Service \u6570\u91cf","type":"stat"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"short"}},"gridPos":{"h":4,"w":4,"x":20,"y":1},"id":6,"options":{"colorMode":"value","graphMode":"area","justifyMode":"center","orientation":"auto","reduceOptions":{"values":false,"calcs":["lastNotNull"],"fields":""},"textMode":"auto"},"targets":[{"expr":"count(kube_namespace_created)","refId":"A"}],"title":"Namespace \u6570\u91cf","type":"stat"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":5},"id":101,"panels":[],"title":"\u8282\u70b9\u8d44\u6e90\u4f7f\u7528","type":"row"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":20,"gradientMode":"opacity","hideFrom":{"tooltip":false,"viz":false,"legend":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"max":100,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":70},{"color":"red","value":90}]},"unit":"percent"}},"gridPos":{"h":8,"w":12,"x":0,"y":6},"id":7,"options":{"legend":{"calcs":["mean","lastNotNull","max"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"expr":"(1 - (avg by (instance) (irate(node_cpu_seconds_total{mode=\"idle\"}[5m])))) * 100","legendFormat":"{{instance}}","refId":"A"}],"title":"\u8282\u70b9 CPU \u4f7f\u7528\u7387","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":20,"gradientMode":"opacity","hideFrom":{"tooltip":false,"viz":false,"legend":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"max":100,"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":70},{"color":"red","value":85}]},"unit":"percent"}},"gridPos":{"h":8,"w":12,"x":12,"y":6},"id":8,"options":{"legend":{"calcs":["mean","lastNotNull","max"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"expr":"(1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100","legendFormat":"{{instance}}","refId":"A"}],"title":"\u8282\u70b9\u5185\u5b58\u4f7f\u7528\u7387","type":"timeseries"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":14},"id":102,"panels":[],"title":"\u5bb9\u5668\u8d44\u6e90\u4f7f\u7528","type":"row"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"opacity","hideFrom":{"tooltip":false,"viz":false,"legend":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"percent"}},"gridPos":{"h":8,"w":12,"x":0,"y":15},"id":9,"options":{"legend":{"calcs":["mean","lastNotNull","max"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"expr":"sum(rate(container_cpu_usage_seconds_total{container!=\"\",container!=\"POD\"}[5m])) by (pod, namespace) * 100","legendFormat":"{{namespace}}/{{pod}}","refId":"A"}],"title":"\u5bb9\u5668 CPU \u4f7f\u7528\u7387 (Top 10)","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"opacity","hideFrom":{"tooltip":false,"viz":false,"legend":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"bytes"}},"gridPos":{"h":8,"w":12,"x":12,"y":15},"id":10,"options":{"legend":{"calcs":["mean","lastNotNull","max"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"expr":"sum(container_memory_working_set_bytes{container!=\"\",container!=\"POD\"}) by (pod, namespace)","legendFormat":"{{namespace}}/{{pod}}","refId":"A"}],"title":"\u5bb9\u5668\u5185\u5b58\u4f7f\u7528 (Top 10)","type":"timeseries"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":23},"id":103,"panels":[],"title":"\u7f51\u7edc\u6d41\u91cf","type":"row"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"opacity","hideFrom":{"tooltip":false,"viz":false,"legend":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"Bps"}},"gridPos":{"h":8,"w":12,"x":0,"y":24},"id":11,"options":{"legend":{"calcs":["mean","lastNotNull","max"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"expr":"sum(rate(container_network_receive_bytes_total{pod!=\"\"}[5m])) by (pod, namespace)","legendFormat":"{{namespace}}/{{pod}} - RX","refId":"A"}],"title":"Pod \u7f51\u7edc\u63a5\u6536\u901f\u7387","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"opacity","hideFrom":{"tooltip":false,"viz":false,"legend":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"Bps"}},"gridPos":{"h":8,"w":12,"x":12,"y":24},"id":12,"options":{"legend":{"calcs":["mean","lastNotNull","max"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"expr":"sum(rate(container_network_transmit_bytes_total{pod!=\"\"}[5m])) by (pod, namespace)","legendFormat":"{{namespace}}/{{pod}} - TX","refId":"A"}],"title":"Pod \u7f51\u7edc\u53d1\u9001\u901f\u7387","type":"timeseries"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":32},"id":104,"panels":[],"title":"\u5b58\u50a8\u4f7f\u7528","type":"row"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"opacity","hideFrom":{"tooltip":false,"viz":false,"legend":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"yellow","value":70},{"color":"red","value":85}]},"unit":"percent"}},"gridPos":{"h":8,"w":12,"x":0,"y":33},"id":13,"options":{"legend":{"calcs":["mean","lastNotNull","max"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"expr":"(1 - (node_filesystem_avail_bytes{fstype!~\"tmpfs|fuse.lxcfs|squashfs|vfat\"} / node_filesystem_size_bytes{fstype!~\"tmpfs|fuse.lxcfs|squashfs|vfat\"})) * 100","legendFormat":"{{mountpoint}} on {{instance}}","refId":"A"}],"title":"\u6587\u4ef6\u7cfb\u7edf\u4f7f\u7528\u7387","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":10,"gradientMode":"opacity","hideFrom":{"tooltip":false,"viz":false,"legend":false},"insertNulls":false,"lineInterpolation":"smooth","lineWidth":2,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"bytes"}},"gridPos":{"h":8,"w":12,"x":12,"y":33},"id":14,"options":{"legend":{"calcs":["mean","lastNotNull","max"],"displayMode":"table","placement":"right","showLegend":true},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"expr":"sum(container_fs_usage_bytes{container!=\"\",container!=\"POD\"}) by (pod, namespace)","legendFormat":"{{namespace}}/{{pod}}","refId":"A"}],"title":"\u5bb9\u5668\u6587\u4ef6\u7cfb\u7edf\u4f7f\u7528","type":"timeseries"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":41},"id":105,"panels":[],"title":"Pod \u72b6\u6001","type":"row"},{"datasource":{"type":"prometheus","uid":"prometheus"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"align":"auto","cellOptions":{"type":"auto"},"inspect":false},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]}},"overrides":[{"matcher":{"id":"byName","options":"\u72b6\u6001"},"properties":[{"id":"custom.cellOptions","value":{"type":"color-text"}},{"id":"mappings","value":[{"type":"value","options":{"Running":{"color":"green","text":"Running"},"Pending":{"color":"yellow","text":"Pending"},"Failed":{"color":"red","text":"Failed"},"Succeeded":{"color":"blue","text":"Succeeded"}}}]}]}]},"gridPos":{"h":8,"w":24,"x":0,"y":42},"id":15,"options":{"cellHeight":"sm","footer":{"countRows":false,"fields":"","reducer":["sum"],"show":false},"showHeader":true},"targets":[{"expr":"kube_pod_info","format":"table","instant":true,"refId":"A"},{"expr":"kube_pod_status_phase","format":"table","instant":true,"refId":"B"}],"title":"Pod \u5217\u8868","transformations":[{"id":"merge","options":{}},{"id":"organize","options":{"excludeByName":{"Time":true,"Value":true,"__name__":true,"job":true,"node":true,"uid":true},"indexByName":{},"renameByName":{"namespace":"Namespace","phase":"\u72b6\u6001","pod":"Pod \u540d\u79f0"}}}],"type":"table"}],"refresh":"30s","schemaVersion":39,"tags":["kubernetes","local","cluster"],"templating":{"list":[]},"time":{"from":"now-1h","to":"now"},"timepicker":{},"timezone":"browser","title":"\u672c\u5730\u7cfb\u7edf & Kubernetes \u96c6\u7fa4\u76d1\u63a7","uid":"local-k8s-monitoring","version":1,"weekStart":""}
